# --------------------------------------------------------------
# MAKEFILE FOR LIBIERS10++ LIBRARY
# PART 2 / MAKEFILE FOR SRC
# @configure_input@
# --------------------------------------------------------------

##
##  WARNING
##  Variable builddir should be overwritten by the top-level
##+ Makefile;
##

##  Include the Makefile configuration file
## ===================================================
include ../Makefile.conf

## Package-related info (set by autoconf)
## ===================================================
package     = @PACKAGE_NAME@
version     = @PACKAGE_VERSION@
tarname     = @PACKAGE_TARNAME@
distdir     = $(tarname)-$(version)

## Path(s)-related info (set by autoconf)
## ===================================================
prefix      = @prefix@
exec_prefix = @exec_prefix@
datarootdir = @datarootdir@
includedir  = @includedir@
docdir      = @docdir@
libdir      = @libdir@

## VPATH-related substitution variables
## ===================================================
srcdir      = @srcdir@
VPATH       = @srcdir@

## Compiler-related substitution variables
## ===================================================
CXX         = @CXX@
CXXFLAGS    = @CXXFLAGS@
DEFS        = @DEFS@
LDFLAGS     = @LDFLAGS@
LIBS        = @LIBS@

## Install-related substitution variables
## ===================================================
INSTALL        = @INSTALL@
INSTALL_DATA   = @INSTALL_DATA@
INSTALL_PROGRAM= @INSTALL_PROGRAM@
INSTALL_SCRIPT = @INSTALL_SCRIPT@

## Source related folders (for convinience)
## ===================================================
dhtdir      = $(srcdir)/dehanttideinel
hspdir      = $(srcdir)/hardisp

## Compiler options
## ===================================================
CXX         = @CXX@
DEFS        = @DEFS@ $(STD_C11) $(OPT_LEVEL) $(USE_EXTERNAL_CONSTS) $(QUICK_EXIT)
CXXFLAGS    = -c -Wall $(DEFS)
LDFLAGS     = -Wall $(DEFS)
LIBS        = @LIBS@

LIB       = $(srcdir)/../$(package)v$(version).a

SRC       = fundarg.cpp  pmsdnut2.cpp  utlibr.cpp fcnnut.cpp arg2.cpp \
            dehanttideinel.cpp rg_zont2.cpp cnmtx.cpp ortho_eop.cpp apg.cpp \
            gpt.cpp gpt2.cpp st1idiu.cpp st1isem.cpp st1l1.cpp step2diu.cpp \
            step2lon.cpp cal2jd.cpp dat.cpp etutc.cpp eval.cpp recurs.cpp \
            shells.cpp utils.cpp spline.cpp tdfrph.cpp admint.cpp

OBJ_     := $(SRC:%.cpp=%.o)
OBJ       = $(addprefix $(builddir)/, $(OBJ_))

HEAD      = $(srcdir)/iers2010.hpp

all: mkdir $(LIB)

mkdir:
	mkdir -p $(builddir)

install:
	$(INSTALL) -d $(libdir)
	$(INSTALL) -d $(includedir)
	$(INSTALL_PROGRAM) -m 0744 $(LIB) $(libdir)
	$(INSTALL_PROGRAM) -m 0744 $(HEAD) $(includedir)

clean:
	-rm $(OBJ) 
	-rm $(LIB)
	-rm -rf $(builddir)

$(LIB): $(OBJ)
	ar rc $(LIB) $(OBJ)
	cp $(LIB) ../$(package).a

Makefile: Makefile.in ../config.status
	cd ../ && ./config.status $@

../config.status: ../configure
	cd ../ && ./config.status --recheck

$(builddir)/fundarg.o: $(srcdir)/fundarg.cpp $(HEAD)
	$(CXX) $(CXXFLAGS) -o $@ $<
$(builddir)/pmsdnut2.o: $(srcdir)/pmsdnut2.cpp ../obj/fundarg.o $(HEAD)
	$(CXX) $(CXXFLAGS) -o $@ $<
$(builddir)/utlibr.o: $(srcdir)/utlibr.cpp ../obj/fundarg.o $(HEAD)
	$(CXX) $(CXXFLAGS) -o $@ $<
$(builddir)/fcnnut.o: $(srcdir)/fcnnut.cpp $(HEAD)
	$(CXX) $(CXXFLAGS) -o $@ $<
$(builddir)/arg2.o: $(srcdir)/arg2.cpp $(HEAD)
	$(CXX) $(CXXFLAGS) -o $@ $<
$(builddir)/rg_zont2.o: $(srcdir)/rg_zont2.cpp $(HEAD) ../obj/fundarg.o
	$(CXX) $(CXXFLAGS) -o $@ $<
$(builddir)/dehanttideinel.o: $(srcdir)/dehanttideinel.cpp $(HEAD)
	$(CXX) $(CXXFLAGS) -o $@ $<
$(builddir)/cnmtx.o: $(srcdir)/cnmtx.cpp $(HEAD)
	$(CXX) $(CXXFLAGS) -o $@ $<
$(builddir)/ortho_eop.o: $(srcdir)/ortho_eop.cpp $(srcdir)/cnmtx.cpp $(HEAD)
	$(CXX) $(CXXFLAGS) -o $@ $<
$(builddir)/gpt.o: $(srcdir)/gpt.cpp $(HEAD)
	$(CXX) $(CXXFLAGS) -o $@ $<
$(builddir)/gpt2.o: $(srcdir)/gpt2.cpp $(HEAD)
	$(CXX) $(CXXFLAGS) -o $@ $<
$(builddir)/apg.o: $(srcdir)/apg.cpp $(HEAD)
	$(CXX) $(CXXFLAGS) -o $@ $<
$(builddir)/st1idiu.o: $(dhtdir)/st1idiu.cpp $(dhtdir)/dehanttideinel.hpp
	$(CXX) $(CXXFLAGS) -o $@ $<
$(builddir)/st1isem.o: $(dhtdir)/st1isem.cpp $(dhtdir)/dehanttideinel.hpp
	$(CXX) $(CXXFLAGS) -o $@ $<
$(builddir)/st1l1.o: $(dhtdir)/st1l1.cpp $(dhtdir)/dehanttideinel.hpp
	$(CXX) $(CXXFLAGS) -o $@ $<
$(builddir)/step2diu.o: $(dhtdir)/step2diu.cpp $(dhtdir)/dehanttideinel.hpp
	$(CXX) $(CXXFLAGS) -o $@ $<
$(builddir)/step2lon.o: $(dhtdir)/step2lon.cpp $(dhtdir)/dehanttideinel.hpp
	$(CXX) $(CXXFLAGS) -o $@ $<
$(builddir)/cal2jd.o: $(dhtdir)/cal2jd.cpp $(dhtdir)/dehanttideinel.hpp
	$(CXX) $(CXXFLAGS) -o $@ $<
$(builddir)/dat.o: $(dhtdir)/dat.cpp $(dhtdir)/dehanttideinel.hpp
	$(CXX) $(CXXFLAGS) -o $@ $<
$(builddir)/admint.o: $(hspdir)/admint.cpp $(hspdir)/hardisp.hpp $(hspdir)/tdfrph.cpp $(hspdir)/spline.cpp $(hspdir)/eval.cpp $(hspdir)/shells.cpp 
	$(CXX) $(CXXFLAGS) -o $@ $<
$(builddir)/etutc.o: $(hspdir)/etutc.cpp $(hspdir)/hardisp.hpp
	$(CXX) $(CXXFLAGS) -o $@ $<
$(builddir)/eval.o: $(hspdir)/eval.cpp $(hspdir)/hardisp.hpp
	$(CXX) $(CXXFLAGS) -o $@ $<
$(builddir)/recurs.o: $(hspdir)/recurs.cpp $(hspdir)/hardisp.hpp
	$(CXX) $(CXXFLAGS) -o $@ $<
$(builddir)/shells.o: $(hspdir)/shells.cpp $(hspdir)/hardisp.hpp
	$(CXX) $(CXXFLAGS) -o $@ $<
$(builddir)/utils.o: $(hspdir)/utils.cpp $(hspdir)/hardisp.hpp
	$(CXX) $(CXXFLAGS) -o $@ $<
$(builddir)/spline.o: $(hspdir)/spline.cpp $(hspdir)/hardisp.hpp
	$(CXX) $(CXXFLAGS) -o $@ $<
$(builddir)/tdfrph.o: $(hspdir)/tdfrph.cpp $(hspdir)/hardisp.hpp $(hspdir)/etutc.cpp $(hspdir)/utils.cpp
	$(CXX) $(CXXFLAGS) -o $@ $<
